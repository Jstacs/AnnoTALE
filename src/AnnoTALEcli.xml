<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Runnable Jar for Project Xanthogenomes">
    <!--this file was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required                                        -->
    <!--define folder properties-->
    <property name="project.root" location="${basedir}/.."/>
    <property name="dist.dir" location="${project.root}/dist"/>
    <property name="build.dir" location="${project.root}/build"/>
    <property name="classes.dir" location="${build.dir}/classes"/>
    <property name="lib.dir" location="${project.root}/lib"/>
    <property name="jstacs.jar" location="${lib.dir}/jstacs-2.5.jar"/>

    <path id="compile.classpath">
        <pathelement location="${jstacs.jar}"/>
        <fileset dir="${lib.dir}">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <target name="create_run_jar">
        <fail message="Required Jstacs jar not found: ${jstacs.jar}">
            <condition>
                <not>
                    <available file="${jstacs.jar}" type="file"/>
                </not>
            </condition>
        </fail>
        <delete dir="${classes.dir}"/>
        <mkdir dir="${classes.dir}"/>
        <mkdir dir="${dist.dir}"/>

        <javac srcdir="${basedir}/main/java" destdir="${classes.dir}" includes="**/*.java"
               includeantruntime="false" classpathref="compile.classpath" />

        <copy todir="${classes.dir}">
            <fileset dir="${basedir}/main/resources"/>
        </copy>

        <jar destfile="${dist.dir}/AnnoTALEcli-1.4.1.jar" filesetmanifest="mergewithoutmain" duplicate="preserve">
            <manifest>
                <attribute name="Main-Class" value="annotale.AnnoTALEcli"/>
                <attribute name="Class-Path" value="."/>
            </manifest>
            <fileset dir="${classes.dir}"/>
            <zipfileset excludes="META-INF/*.SF,META-INF/MANIFEST.MF,**/clusters.xml,lib/**/*.jar,projects/gemoma/**,projects/motifComp/**,annotale/**,projects/xanthogenomes/**" src="${jstacs.jar}"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/numericalMethods.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/RClient-0.6.7.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/ssj/colt-1.2.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/ssj/ssj-3.3.1.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/htsjdk-2.5.0-4-gd683012-SNAPSHOT.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/bytecode-1.9.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/core-1.9.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-anim.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-awt-util.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-bridge.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-codec.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-css.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-dom.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-ext.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-extension.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-gui-util.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-gvt.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-parser.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-script.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-svg-dom.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-svggen.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-swing.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-transcoder.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-util.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik-xml.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/batik.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/commons-io-1.3.1.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/commons-logging-1.0.4.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/pdf-transcoder.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/xml-apis-ext.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/xml-commons/xmlgraphics-commons-1.5.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="${lib.dir}/Jama-1.0.3.jar"/>
        </jar>
    </target>
</project>
